(this.webpackJsonpgrunt_js=this.webpackJsonpgrunt_js||[]).push([[0],{213:function(e,t,n){e.exports=n(380)},218:function(e,t,n){},219:function(e,t,n){},380:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(23),l=n.n(i),o=(n(218),n(17)),c=(n(219),n(54)),s=n.n(c),u=n(81),m=n(67),p=n(68),h=n(92),d=n(90),f=n(389),v=n(210),E=n(387),g=n(41),b=n(382),_=n(384),y=n(177),w=n.n(y),k=n(178),x=n.n(k),j="https://api.openwrt-build.cf";console.log("baseURL",j);var O=new(function(){function e(){Object(m.a)(this,e),this.http=null,this.http=x.a.create({baseURL:j}),this.http.interceptors.response.use((function(e){return e}),(function(e){var t=e;if(t.response&&401===(t=t.response).status)return v.b.warn("\u4f1a\u8bdd\u8fc7\u671f\u91cd\u65b0\u767b\u5f55",1,(function(){window.location.reload()})),sessionStorage.clear(),Promise.reject(e);t.data&&(t=t.data),t.message&&(t=t.message),console.log("[Error]",t);var n="string"===typeof t?t:JSON.stringify(t);return v.b.error(n),Promise.reject(e)}))}return Object(p.a)(e,[{key:"setJwt",value:function(e){console.log("setJwt",e),this.jwt=e,this.http.defaults.headers.Authorization="Bearer ".concat(e)}},{key:"getAuthUrl",value:function(e){return this.http.get("/login",{params:{callbackUrl:e}})}},{key:"login",value:function(e){return this.http.post("/login",e)}},{key:"getRepo",value:function(){return this.http.get("/repos/OpenWrtBuild")}},{key:"getRuns",value:function(){return this.http.get("/repos/OpenWrtBuild/runs")}},{key:"addRun",value:function(e){return this.http.post("/repos/OpenWrtBuild/runs",e)}},{key:"rmRun",value:function(e){return this.http.delete("/repos/OpenWrtBuild/runs/".concat(e))}}]),e}()),I=n(388),C=n(180),R=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return a.a.createElement(C.a,{indicator:a.a.createElement(I.a,null)})}}]),n}(r.Component),D=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={authUrl:null,jwt:null},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.login()}},{key:"login",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,r,a,i,l,o,c,u,m,p,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=sessionStorage.getItem("jwt"))){e.next=5;break}this.onJwt(t),e.next=25;break;case 5:if(n=window,r=n.location,a=n.history,i=r.search,l=r.href,!("code"in(o=w.a.parse(i.substr(1))))){e.next=19;break}return c=v.b.loading("Loading...",0),e.next=12,O.login(o);case 12:u=e.sent,m=u.data,this.onJwt(m),c(),a.pushState({},null,r.origin),e.next=25;break;case 19:return e.next=21,O.getAuthUrl(l);case 21:p=e.sent,h=p.data,console.log("getAuthUrl",h),this.setState({authUrl:h});case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onJwt",value:function(e){sessionStorage.setItem("jwt",e),O.setJwt(e),this.setState({jwt:e})}},{key:"render",value:function(){var e=this.state,t=e.authUrl;return e.jwt?this.props.children:a.a.createElement("div",null,t?a.a.createElement(E.b,{direction:"vertical"},a.a.createElement(g.a,{type:"primary",size:"large",icon:a.a.createElement(f.a,null),onClick:function(){window.location.href=t}},"\u767b\u5f55"),a.a.createElement(b.a,{title:"\u5de5\u4f5c\u539f\u7406"},a.a.createElement("ol",null,a.a.createElement("li",null,"\u6388\u6743Github\u767b\u5f55"),a.a.createElement("li",null,"\u521b\u5efa\u7f16\u8bd1\u4ed3\u5e93\uff08\u5728\u60a8\u4e2a\u4eba\u7684\u8d26\u53f7\u4e0b\uff09"),a.a.createElement("li",null,"\u6839\u636e\u60a8\u9009\u62e9\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u89e6\u53d1Actions\u8fdb\u884c\u7f16\u8bd1"),a.a.createElement("li",null,"\u4e0b\u8f7d\u56fa\u4ef6"))),a.a.createElement(b.a,{title:"\u9690\u79c1\u58f0\u660e"},a.a.createElement("ol",{style:{color:"#ff4d4f"}},a.a.createElement("li",null,"\u672c\u5de5\u5177\u65e8\u5728\u7b80\u5316\u60a8\u7684\u56fa\u4ef6\u7f16\u8bd1\u6d41\u7a0b\uff0c"),a.a.createElement("li",null,"\u6240\u6709\u6570\u636e\u5747\u5b58\u50a8\u4e8e\u60a8\u7684\u4e2a\u4eba\u4ee3\u7801\u4ed3\u5e93"),a.a.createElement("li",null,"\u672c\u7ad9\u4e0d\u4f1a\u5b58\u50a8\u60a8\u7684\u4efb\u4f55\u4eba\u4e2a\u4fe1\u606f"),a.a.createElement("li",null,"\u8bf7\u653e\u5fc3\u4f7f\u7528")),a.a.createElement(_.a.Text,{type:"danger"}))):a.a.createElement(R,null))}}]),n}(r.Component),S=n(390),V=n(391),A=n(392),B=n(381),J=n(385),U=n(383),P=n(102),T=n(386),W=n(189),z=n.n(W),F=n(190),N=n.n(F),L={esir_Newifi_D2:"[esirplayground] Newifi D2",esir_redmi_ac2100:"[esirplayground] Redmi AC2100",esir_x86:"[esirplayground] x86",esir_x86_64:"[esirplayground] x86_64",x86_64_DEVICE_generic:"x86_64",x86_generic_DEVICE_generic:"x86","bcm27xx_bcm2711_DEVICE_rpi-4":"Raspberry Pi 4 Model B",ramips_mt7620_DEVICE_hiwifi_hc5661:null,ramips_mt7620_DEVICE_hiwifi_hc5761:null,ramips_mt7621_DEVICE_phicomm_k2p:null,"ramips_mt7621_DEVICE_xiaomi_mi-router-ac2100":null,ramips_mt7621_DEVICE_xiaomi_mir3g:null,"ramips_mt7621_DEVICE_xiaomi_mir3g-v2":null,ramips_mt7621_DEVICE_xiaomi_mir3p:null,ramips_mt7621_DEVICE_xiaomi_mir4:null,"ramips_mt7621_DEVICE_xiaomi_redmi-router-ac2100":"Redmi AC2100"},M=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={repo:null,runs:[],v:!1},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.getRepo()}},{key:"getRepo",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v.b.loading("\u83b7\u53d6\u4ed3\u5e93\u4fe1\u606f",0),e.prev=1,e.next=4,O.getRepo();case 4:n=e.sent,r=n.data,console.log("getRepo",r),this.setState({repo:r});case 8:return e.prev=8,t(),e.finish(8);case 11:this.getRuns();case 12:case"end":return e.stop()}}),e,this,[[1,,8,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"getRuns",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v.b.loading("\u83b7\u53d6\u4efb\u52a1\u5217\u8868",0),e.prev=1,e.next=4,O.getRuns();case 4:n=e.sent,r=n.data,console.log("getRuns",r),this.setState({runs:r});case 8:return e.prev=8,t(),e.finish(8);case 11:case"end":return e.stop()}}),e,this,[[1,,8,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"build",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=v.b.loading("\u63d0\u4ea4\u7f16\u8bd1\u8bf7\u6c42",0),e.prev=1,e.next=4,O.addRun(t);case 4:return e.prev=4,n(),e.finish(4);case 7:setTimeout(this.getRuns.bind(this),1500);case 8:case"end":return e.stop()}}),e,this,[[1,,4,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=v.b.loading("\u53d6\u6d88\u4efb\u52a1 [".concat(t,"]"),0),e.prev=1,e.next=4,O.rmRun(t);case 4:return e.prev=4,n(),v.b.success("\u53d6\u6d88\u7533\u8bf7\u8bf7\u6c42\u5df2\u63d0\u4ea4"),e.finish(4);case 8:setTimeout(this.getRuns.bind(this),3e3);case 9:case"end":return e.stop()}}),e,this,[[1,,4,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onFinish",value:function(e){console.log("onFinish",e),this.build(e),this.setState({v:!1})}},{key:"render",value:function(){var e=this,t=this.state,n=t.repo,r=t.runs,i=t.v;return n?a.a.createElement("div",null,a.a.createElement(E.b,{direction:"vertical"},a.a.createElement("div",null,a.a.createElement("a",{href:n.html_url,target:"_blank",rel:"noopener noreferrer"},n.name," [",n.id,"]")),a.a.createElement(E.b,null,a.a.createElement(g.a,{type:"primary",icon:a.a.createElement(S.a,null),onClick:function(){return e.setState({v:!0})}},"\u7f16\u8bd1"),a.a.createElement(g.a,{icon:a.a.createElement(V.a,null),onClick:this.getRuns.bind(this)},"\u5237\u65b0")),!z.a.isEmpty(r)&&a.a.createElement(B.a,{columns:[{title:"ID",dataIndex:"id",render:function(e,t){return a.a.createElement("a",{href:t.html_url,target:"_blank",rel:"noopener noreferrer"},e)}},{title:"\u72b6\u6001",dataIndex:"status"},{title:"\u7ed3\u679c",dataIndex:"conclusion"},{title:"\u5907\u6ce8",dataIndex:["head_commit","message"]},{title:"\u56fa\u4ef6",dataIndex:["artifacts_url"],render:function(e,t){return"success"===t.conclusion&&a.a.createElement("a",{href:t.html_url,target:"_blank",rel:"noopener noreferrer"},"\u4e0b\u8f7d")}},{title:"\u64cd\u4f5c",render:function(t){return a.a.createElement("div",null,!t.conclusion&&a.a.createElement(g.a,{size:"small",danger:!0,icon:a.a.createElement(A.a,null),onClick:e.cancel.bind(e,t.id)},"\u53d6\u6d88"))}}],dataSource:r,rowKey:"id",size:"small",bordered:!0,pagination:!1})),a.a.createElement(J.a,{title:"\u7f16\u8bd1\u53c2\u6570",visible:i,onCancel:function(){e.setState({v:!1})},okText:"\u7f16\u8bd1",okButtonProps:{form:"build",htmlType:"submit"}},a.a.createElement(U.a,{id:"build",layout:"vertical",onFinish:this.onFinish.bind(this)},a.a.createElement(U.a.Item,{label:"\u76ee\u6807\u8bbe\u5907",name:"name",rules:[{required:!0}]},a.a.createElement(P.a,{placeholder:"--- \u8bf7\u9009\u62e9 ---"},Object.keys(L).map((function(e){return a.a.createElement(P.a.Option,{key:e,value:e},L[e]?L[e]:e)})))),a.a.createElement(U.a.Item,{label:"\u672c\u5730\u5730\u5740",name:"ip",initialValue:"192.168.123.1",rules:[{required:!0},{validator:function(e,t){return t&&!N()(t)?Promise.reject("\u672c\u5730\u5730\u5740\u683c\u5f0f\u4e0d\u5bf9"):Promise.resolve()}}]},a.a.createElement(T.a,null)),a.a.createElement(_.a.Text,{type:"danger"},"\u5373\u5c06\u5f00\u653e\u4e0a\u4f20\u81ea\u5b9a\u4e49\u914d\u7f6e\u6587\u4ef6\u7f16\u8bd1\u529f\u80fd\uff0c\u656c\u8bf7\u671f\u5f85\uff0c\u8c22\u8c22\uff01")))):a.a.createElement(R,null)}}]),n}(r.Component),q=n(205);var G=function(){return a.a.createElement(o.b,{locale:q.a},a.a.createElement("div",{className:"m-3"},a.a.createElement(D,null,a.a.createElement(M,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(a.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[213,1,2]]]);